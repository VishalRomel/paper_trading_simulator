<!DOCTYPE html>
<html>
<head>
	<link rel="stylesheet" type="text/css" href="style.css">
	<script src="https://cdn.jsdelivr.net/npm/chart.js@2.9.3/dist/Chart.min.js"></script>
	<script src="https://cdnjs.cloudflare.com/ajax/libs/axios/0.21.1/axios.min.js"></script>
</head>

<body>

	<div id = "container">
	</div>
	
  <script>

	let companies = [
	"AAL",
	"AAPL",
	"ABBV",
	"ABNB",
	"ABT",
	"ACGL",
	"ACN",
	"ADBE",
	"ADI",
	"ADM",
	"ADP",
	"ADSK",
	"AEE",
	"AEP",
	"AES",
	"AFL",
	"AIG",
	"AIZ",
	"AJG",
	"AKAM",
	"ALB",
	"ALGN",
	"ALK",
	"ALL",
	"ALLE",
	"AMAT",
	"AMCR",
	"AMD",
	"AME",
	"AMGN",
	"AMP",
	"AMT",
	"AMZN",
	"ANET",
	"ANSS",
	"AON",
	"AOS",
	"APA",
	"APD",
	"APH",
	"APTV",
	"ARE",
	"ATO",
	"ATVI",
	"AVB",
	"AVGO",
	"AVY",
	"AWK",
	"AXON",
	"AXP",
	"AZO",
	"BA",
	"BAC",
	"BALL",
	"BAX",
	"BBWI",
	"BBY",
	"BDX",
	"BEN",
	"BF.B",
	"BG",
	"BIIB",
	"BIO",
	"BK",
	"BKNG",
	"BKR",
	"BLK",
	"BMY",
	"BR",
	"BRK.B",
	"BRO",
	"BSX",
	"BWA",
	"BX",
	"BXP",
	"C",
	"CAG",
	"CAH",
	"CARR",
	"CAT",
	"CB",
	"CBOE",
	"CBRE",
	"CCI",
	"CCL",
	"CDAY",
	"CDNS",
	"CDW",
	"CE",
	"CEG",
	"CF",
	"CFG",
	"CHD",
	"CHRW",
	"CHTR",
	"CI",
	"CINF",
	"CL",
	"CLX",
	"CMA",
	"CMCSA",
	"CME",
	"CMG",
	"CMI",
	"CMS",
	"CNC",
	"CNP",
	"COF",
	"COO",
	"COP",
	"COR",
	"COST",
	"CPB",
	"CPRT",
	"CPT",
	"CRL",
	"CRM",
	"CSCO",
	"CSGP",
	"CSX",
	"CTAS",
	"CTLT",
	"CTRA",
	"CTSH",
	"CTVA",
	"CVS",
	"CVX",
	"CZR",
	"D",
	"DAL",
	"DD",
	"DE",
	"DFS",
	"DG",
	"DGX",
	"DHI",
	"DHR",
	"DIS",
	"DLR",
	"DLTR",
	"DOV",
	"DOW",
	"DPZ",
	"DRI",
	"DTE",
	"DUK",
	"DVA",
	"DVN",
	"DXC",
	"DXCM",
	"EA",
	"EBAY",
	"ECL",
	"ED",
	"EFX",
	"EG",
	"EIX",
	"EL",
	"ELV",
	"EMN",
	"EMR",
	"ENPH",
	"EOG",
	"EPAM",
	"EQIX",
	"EQR",
	"EQT",
	"ES",
	"ESS",
	"ETN",
	"ETR",
	"ETSY",
	"EVRG",
	"EW",
	"EXC",
	"EXPD",
	"EXPE",
	"EXR",
	"F",
	"FANG",
	"FAST",
	"FCX",
	"FDS",
	"FDX",
	"FE",
	"FFIV",
	"FI",
	"FICO",
	"FIS",
	"FITB",
	"FLT",
	"FMC",
	"FOX",
	"FOXA",
	"FRT",
	"FSLR",
	"FTNT",
	"FTV",
	"GD",
	"GE",
	"GEHC",
	"GEN",
	"GILD",
	"GIS",
	"GL",
	"GLW",
	"GM",
	"GNRC",
	"GOOG",
	"GOOGL",
	"GPC",
	"GPN",
	"GRMN",
	"GS",
	"GWW",
	"HAL",
	"HAS",
	"HBAN",
	"HCA",
	"HD",
	"HES",
	"HIG",
	"HII",
	"HLT",
	"HOLX",
	"HON",
	"HPE",
	"HPQ",
	"HRL",
	"HSIC",
	"HST",
	"HSY",
	"HUM",
	"HWM",
	"IBM",
	"ICE",
	"IDXX",
	"IEX",
	"IFF",
	"ILMN",
	"INCY",
	"INTC",
	"INTU",
	"INVH",
	"IP",
	"IPG",
	"IQV",
	"IR",
	"IRM",
	"ISRG",
	"IT",
	"ITW",
	"IVZ",
	"J",
	"JBHT",
	"JCI",
	"JKHY",
	"JNJ",
	"JNPR",
	"JPM",
	"K",
	"KDP",
	"KEY",
	"KEYS",
	"KHC",
	"KIM",
	"KLAC",
	"KMB",
	"KMI",
	"KMX",
	"KO",
	"KR",
	"KVUE",
	"L",
	"LDOS",
	"LEN",
	"LH",
	"LHX",
	"LIN",
	"LKQ",
	"LLY",
	"LMT",
	"LNT",
	"LOW",
	"LRCX",
	"LUV",
	"LVS",
	"LW",
	"LYB",
	"LYV",
	"MA",
	"MAA",
	"MAR",
	"MAS",
	"MCD",
	"MCHP",
	"MCK",
	"MCO",
	"MDLZ",
	"MDT",
	"MET",
	"META",
	"MGM",
	"MHK",
	"MKC",
	"MKTX",
	"MLM",
	"MMC",
	"MMM",
	"MNST",
	"MO",
	"MOH",
	"MOS",
	"MPC",
	"MPWR",
	"MRK",
	"MRNA",
	"MRO",
	"MS",
	"MSCI",
	"MSFT",
	"MSI",
	"MTB",
	"MTCH",
	"MTD",
	"MU",
	"NCLH",
	"NDAQ",
	"NDSN",
	"NEE",
	"NEM",
	"NFLX",
	"NI",
	"NKE",
	"NOC",
	"NOW",
	"NRG",
	"NSC",
	"NTAP",
	"NTRS",
	"NUE",
	"NVDA",
	"NVR",
	"NWS",
	"NWSA",
	"NXPI",
	"O",
	"ODFL",
	"OGN",
	"OKE",
	"OMC",
	"ON",
	"ORCL",
	"ORLY",
	"OTIS",
	"OXY",
	"PANW",
	"PARA",
	"PAYC",
	"PAYX",
	"PCAR",
	"PCG",
	"PEAK",
	"PEG",
	"PEP",
	"PFE",
	"PFG",
	"PG",
	"PGR",
	"PH",
	"PHM",
	"PKG",
	"PLD",
	"PM",
	"PNC",
	"PNR",
	"PNW",
	"PODD",
	"POOL",
	"PPG",
	"PPL",
	"PRU",
	"PSA",
	"PSX",
	"PTC",
	"PWR",
	"PXD",
	"PYPL",
	"QCOM",
	"QRVO",
	"RCL",
	"REG",
	"REGN",
	"RF",
	"RHI",
	"RJF",
	"RL",
	"RMD",
	"ROK",
	"ROL",
	"ROP",
	"ROST",
	"RSG",
	"RTX",
	"RVTY",
	"SBAC",
	"SBUX",
	"SCHW",
	"SEDG",
	"SEE",
	"SHW",
	"SJM",
	"SLB",
	"SNA",
	"SNPS",
	"SO",
	"SPG",
	"SPGI",
	"SRE",
	"STE",
	"STLD",
	"STT",
	"STX",
	"STZ",
	"SWK",
	"SWKS",
	"SYF",
	"SYK",
	"SYY",
	"T",
	"TAP",
	"TDG",
	"TDY",
	"TECH",
	"TEL",
	"TER",
	"TFC",
	"TFX",
	"TGT",
	"TJX",
	"TMO",
	"TMUS",
	"TPR",
	"TRGP",
	"TRMB",
	"TROW",
	"TRV",
	"TSCO",
	"TSLA",
	"TSN",
	"TT",
	"TTWO",
	"TXN",
	"TXT",
	"TYL",
	"UAL",
	"UDR",
	"UHS",
	"ULTA",
	"UNH",
	"UNP",
	"UPS",
	"URI",
	"USB",
	"V",
	"VFC",
	"VICI",
	"VLO",
	"VMC",
	"VRSK",
	"VRSN",
	"VRTX",
	"VTR",
	"VTRS",
	"VZ",
	"WAB",
	"WAT",
	"WBA",
	"WBD",
	"WDC",
	"WEC",
	"WELL",
	"WFC",
	"WHR",
	"WM",
	"WMB",
	"WMT",
	"WRB",
	"WRK",
	"WST",
	"WTW",
	"WY",
	"WYNN",
	"XEL",
	"XOM",
	"XRAY",
	"XYL",
	"YUM",
	"ZBH",
	"ZBRA",
	"ZION",
	"ZTS",
	];

	// Get a reference to the container div
	const container = document.getElementById("container");

	// Create 20 div elements with canvas elements inside
	for (let i = 1; i < 100; i++) {
		// Create a new div element
		const div = document.createElement("div");

		// Set the id attribute for the div
		div.id = "canvas" + i;

		// Create a H2 element
		const h2 = document.createElement("h2");
		h2.id = "h2" + i;
		h2.textContent = companies[i]

		// Append the H2 element to the div
		div.appendChild(h2);


		// Create a canvas element
		const canvas = document.createElement("canvas");
		canvas.id = "myChart" + i;

		// Append the canvas element to the div
		div.appendChild(canvas);

		// Append the div to the container
		container.appendChild(div);

		////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
		axios.post('http://localhost:3000/av', {stock: companies[i-1]})
		.then(response => {
		// response.data contains response from API
			console.log(response.data)
			var data = response.data;
	
	
			
			// Extract labels and data 
			const labels = data.map(item => item.week);
			labels.reverse();
			const prices = data.map(item => item.price);
			prices.reverse();
	
			const chartData = {
				labels: labels,
				datasets: [
				  {
					label: 'Weekly Stock Prices',
					data: prices,
					borderColor: 'rgba(0, 128, 0, 1)', // Green color
					backgroundColor: 'rgba(0, 0, 0, 0)', // Transparent fill
					tension: 0.1,
					pointBackgroundColor: 'rgba(0, 0, 0, 0)', // Transparent data points
				  },
				],
			  };
			  
			  // Get canvas context
			  const ctx = document.getElementById('myChart' + i).getContext('2d');
			  
			  // Create chart
			  const myChart = new Chart(ctx, {
				type: 'line',
				data: chartData,
				options: {
				  scales: {
					y: {
					  beginAtZero: false,
					},
				  },
				  plugins: {
					legend: {
					  labels: {
						color: 'black', // Black legend text color
					  },
					},
				  },
				},
			  });
		});
		////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
	}
  </script>

</body>
</html>